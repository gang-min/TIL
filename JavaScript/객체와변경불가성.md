# 객체와 변경불가성(Immutability)

## 1. `immutable value vs. mutable value`

### 1-1. `Javascript의 원시 타입(primitive data type)은 변경 불가능한 값(immutable value)이다.`

- number, string, undefined, null, boolean, symbol

- 원시 타입 이외의 모든 값은 객체(Object) 타입이며, 객체 타입은 변경 가능한 값(mutable value)이다. 즉, 객체는 새로운 값을 다시 만들 필요 없이 직접 변경이 가능하다는 것이다.

- 예를 들어 살펴보자.

  - `string은 원시타입`으로 `변경 불가능한 값(immutable value)`이다.

  > 변경 불가능하다는 뜻은 메모리 영역에서 변경이 불가능하다는 뜻이다. 재할당은 가능하다.

  ![string](/image/string.png)

  - 첫번 쨰 구분이 실행되면 메모리에 문자열 'Hello'가 생성되고 식별자 str은 메모리에 생성된 문자열 'Hello'의 메모리 주소를 가리킨다

  - 그리고 두번 쨰 구문이 실행되면 이전의 생성된 문자열 'Hello'를 수정하는 것이 아니라 새로운 문자열 'world'를 메모리에 생성하고 식별자 str은 이것을 가리킨다.

  ![string](/image/유사배열.png)

  - 문자열은 배열처럼 인덱스를 통해 접근할 수 있다. 이와 같은 특성을 갖는 데이터를 `유사배열`이라 한다.

  - str[0] = 'S'처럼 이미 생성된 문자열의 일부 문자를 변경해도 반영되지 않는다.(이때 에러가 발생하지 않는다.) 한번 생성된 문자열은 read only로서 변경할 수 없다. `이것을 변경 불가능(immutable)이라 한다.`

  - 그러나 새로운 문자열을 재할당하는 것은 물론 가능하다. 이는 기존 문자열을 변경하는 것이 아니라 새로운 문자열을 새롭게 할당하는 것이기 떄문이다.

- 원시 타입(primitive value)는 값(value)로 전달된다. 즉, `값이 복사`되어 전달된다. 이를 `pass-by-value(값에 의한 전달)`라 한다. 원시 타입은 값이 한번 정해지면 변경할 수 없다.(immutable)

  ![passbyvalue](/image/passbyvalue.png)

  - 변수 a는 원시 타입인 number 타입 1을 저장하고 있다. 원시 타입의 경우 값이 복사되어 변수에 저장된다. 즉, 참조 타입으로 저장되는 것이 아니라 값 자체가 저장되게 된다. 변수 b에 변수 a를 할당할 경우, 변수 a의 값 1이 복사되어 변수 b에 저장된다.

### 1-2. `Javascript의 원시 타입(primitive data type)을 제외한 나머지 값들은 모두 객체이다.`

- object type을 객체 타입 또는 참조 타입이라 한다. 참조 타입이란 객체의 모든 연산이 실제값이 아닌 `참조값`으로 처리됨을 의미한다.

- 이를 `Pass-by-reference(참조에 의한 전달)`이라 한다.

- 객체는 참조(reference) 형태로 전달하고 전달 받는다. 객체가 참조를 통해 공유되어 있다면 그 상태가 언제든지 변경될 수 있기 때문에 문제가 될 가능성도 커지게 된다. 이는 객체의 참조를 가지고 있는 어떤 장소에서 객체를 변경하면 참조를 공유하는 모든 장소에서 그 영향을 받기 때문이다.

- 원시 타입은 값이 한번 정해지면 변경할 수 없지만(immutable), 객체는 프로퍼티를 변경, 추가, 삭제가 가능하므로 변경 가능(mutable)한 값이라 할 수 있다.

  ![reference](/image/reference.png)

  - 변수 foo는 객체 자체를 저장하고 있는 것이 아니라 생성된 객체의 참조값(address)를 저장하고 있다.

  - 변수 bar에 변수 foo의 값을 할당하였다. 변수 foo의 값은 생성된 객체를 가리키는 참조값이므로 변수 bar에도 똑같은 참조값이 저장된다.

    ![reference](/image/reference2.png)

  - 즉, 변수 foo, bar 모두 동일한 객체를 참조하고 있다. 따라서 참조하고 있는 객체의 val값이 변경되면 변수 foo, bar 모두 동일한 객체를 참조하고 있으므로 두 변수 모두 변경된 객체의 프로퍼티 값을 참조하게 된다.

  > 객체는 참조(reference)방식으로 전달된다. 결코 복사되지 않는다.
